<Page x:Class="WpfApp1.Pages.UserGardenPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:sys="clr-namespace:System;assembly=mscorlib"
      Title="Мои растения">

    <Grid Background="White">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Row 0: верхняя панель с фильтрами и уведомлениями -->
        <DockPanel Grid.Row="0" Margin="10">

            <!-- Левая часть — фильтры, поиск, “Добавить растение” -->
            <StackPanel DockPanel.Dock="Left"
                Orientation="Horizontal"
                VerticalAlignment="Center">
                <ComboBox x:Name="ComboFilter"
                  Width="160" Height="23" Margin="5"
                  SelectionChanged="ComboFilter_SelectionChanged"/>
                <ComboBox x:Name="ComboSort"
                  Width="160" Height="23" Margin="5"
                  SelectionChanged="ComboSort_SelectionChanged">
                    <ComboBoxItem Content="Название А-Я"/>
                    <ComboBoxItem Content="Название Я-А"/>
                    <ComboBoxItem Content="Дата ухода ↑"/>
                    <ComboBoxItem Content="Дата ухода ↓"/>
                </ComboBox>
                <TextBox  x:Name="TextSearch"
                  Width="200" Height="23" Margin="5"
                  TextChanged="TextSearch_TextChanged"/>

                <Button  x:Name="bCreatePlant"
                 Content="➕ Добавить растение"
                 Background="#4CAF50"
                 Foreground="White"
                 Padding="10,2"
                 Margin="10,0,0,0"
                 Height="35"
                 Click="bCreatePlant_Click"/>
            </StackPanel>

            <!-- Правая часть — уведомления -->
            <StackPanel DockPanel.Dock="Right"
                Orientation="Vertical"
                Cursor="Hand"
                VerticalAlignment="Center"
                MouseDown="GoToNotifications_Click">
                <TextBlock Text="🔔"
                   FontSize="32"
                   HorizontalAlignment="Center"/>
                <TextBlock Text="Уведомления"
                   FontSize="12"
                   FontWeight="SemiBold"
                   Foreground="Black"
                   HorizontalAlignment="Center"
                   Margin="0,4,0,0"/>
            </StackPanel>
        </DockPanel>


        <!-- Список растений -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
            <ItemsControl x:Name="ListUserPlants" Margin="0">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <WrapPanel IsItemsHost="True"
                           Orientation="Horizontal"
                           HorizontalAlignment="Center"
                           Margin="0"
                           ItemWidth="290"
                           ItemHeight="Auto"/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Border Width="270" Margin="10"
                        BorderBrush="#DDD"
                        BorderThickness="1"
                        Padding="10">
                            <StackPanel>
                                <Image Source="{Binding PhotoPath}" Height="120" Width="250" Stretch="UniformToFill"/>
                                <TextBlock Text="{Binding Name}" FontSize="16" FontWeight="Bold" Margin="0,5,0,0"/>
                                <TextBlock Text="{Binding Description}" FontSize="12" TextWrapping="Wrap" Margin="0,5,0,0"/>
                                <TextBlock Text="{Binding CategoryName}" FontStyle="Italic" Foreground="Gray" Margin="0,5,0,0"/>
                                <TextBlock FontSize="12" Foreground="DarkSlateGray" Margin="0,5,0,0">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding PurchaseDate}" Value="{x:Null}">
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding PurchaseDate}">
                                                    <Setter Property="Visibility" Value="Visible"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                    <TextBlock.Text>
                                        <Binding Path="PurchaseDate" StringFormat="Посажено: {0:dd.MM.yyyy}"/>
                                    </TextBlock.Text>
                                </TextBlock>

                                <TextBlock Text="{Binding LastCareDate, StringFormat=Уход: dd.MM.yyyy}" FontSize="12" Foreground="DarkSlateGray" Margin="0,5,0,0"/>
                                <TextBlock Text="{Binding CareSchedule}" FontSize="12" Foreground="Green" Margin="0,5,0,0"/>
                                <TextBlock Text="{Binding Notes}" FontSize="12" Foreground="Red" Margin="0,5,0,0"/>
                                <TextBlock Text="{Binding MinTemp, StringFormat=Мин. темп.: {0}°C}" FontSize="12" Foreground="Blue" Margin="0,5,0,0"/>
                                <TextBlock Text="{Binding MaxTemp, StringFormat=Макс. темп.: {0}°C}" FontSize="12" Foreground="Blue" Margin="0,5,0,0"/>
                                <TextBlock Text="{Binding WateringAmount, StringFormat=Полив: {0} мл}" FontSize="12" Foreground="Brown" Margin="0,5,0,0"/>
                                <TextBlock Text="{Binding FertilizerName, StringFormat=Удобрение: {0}}" FontSize="12" Foreground="Green" Margin="0,5,0,0"/>
                                <TextBlock Text="{Binding FertilizerDosage, StringFormat=Дозировка: {0} мл}" FontSize="12" Foreground="Green" Margin="0,5,0,0"/>
                                <TextBlock Text="{Binding LightingLevel, StringFormat=Освещение: {0}}" FontSize="12" Foreground="Orange" Margin="0,5,0,0"/>

                                <!-- Искусственное освещение -->
                                <TextBlock Text="Искусственное освещение: Да"
                                           FontSize="12" Foreground="Orange" Margin="0,5,0,0"
                                           Visibility="Collapsed">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding UsesLights}" Value="True">
                                                    <Setter Property="Visibility" Value="Visible"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>

                                <!-- Комната (скрытие если null/пусто) -->
                                <TextBlock FontSize="12" Foreground="Black" Margin="0,5,0,0">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding RoomName}" Value="{x:Null}">
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding RoomName}" Value="">
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding RoomName}">
                                                    <Setter Property="Visibility" Value="Visible"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                    <TextBlock.Text>
                                        <MultiBinding StringFormat="Комната: {0}">
                                            <Binding Path="RoomName"/>
                                        </MultiBinding>
                                    </TextBlock.Text>
                                </TextBlock>

                                <!-- Окно (скрытие если null/пусто) -->
                                <TextBlock FontSize="12" Foreground="Black" Margin="0,5,0,0">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding WindowPosition}" Value="{x:Null}">
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding WindowPosition}" Value="">
                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding WindowPosition}">
                                                    <Setter Property="Visibility" Value="Visible"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                    <TextBlock.Text>
                                        <MultiBinding StringFormat="Окно: {0}">
                                            <Binding Path="WindowPosition"/>
                                        </MultiBinding>
                                    </TextBlock.Text>
                                </TextBlock>

                                <!-- Кнопки -->
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,10,0,0">
                                    <Button Content="Редактировать" Background="LightBlue" Foreground="White"
                                            Padding="10,2" Click="EditUserPlant_Click" Tag="{Binding}" Margin="0,0,10,0"/>
                                    <Button Content="Удалить" Background="Red" Foreground="White"
                                            Padding="10,2" Click="DeleteUserPlant_Click" Tag="{Binding}"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>

        <!-- Нижняя панель -->
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10" Grid.Row="2">
            <TextBlock x:Name="CountRecords" VerticalAlignment="Center" Margin="10,0"/>
        </StackPanel>
    </Grid>
</Page>
